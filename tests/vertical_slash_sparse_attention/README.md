# Performance Benchmark

## Hardware & Environment
- **Hardware**: NVIDIA H100 PCIe
- **CUDA version**: 12.8.1
- **PyTorch Version**: 2.7.1+cu128
- **Triton Version**: 3.3.1

## Performance Results

| q/k/v shape | vs_list | Triton Time(ms) | TileLang Time(ms) | Triton TFlops | TileLang TFlops | Triton IO bandwidth(TB/s) | TileLang IO bandwidth(TB/s) | Speedup |
|------------|---------|----------------|----------------|--------------|----------------|------------------------|------------------------|----------|
| [1, 1, 8192, 64] | [1000, 200] | 0.170 | 0.098 | 44.539 | 77.340 | 0.709 | 1.231 | 1.736x |
| [1, 1, 8192, 64] | [1000, 600] | 0.209 | 0.114 | 41.317 | 75.974 | 0.656 | 1.206 | 1.839x |
| [1, 1, 8192, 64] | [800, 600] | 0.204 | 0.114 | 42.392 | 76.040 | 0.673 | 1.207 | 1.794x |
| [1, 1, 16384, 64] | [1000, 200] | 0.261 | 0.153 | 78.338 | 133.934 | 1.241 | 2.122 | 1.710x |
| [1, 1, 16384, 64] | [1000, 600] | 0.423 | 0.239 | 78.190 | 138.294 | 1.232 | 2.179 | 1.769x |
| [1, 1, 16384, 64] | [800, 600] | 0.423 | 0.239 | 78.067 | 138.174 | 1.230 | 2.177 | 1.770x |
| [1, 1, 32768, 64] | [1000, 200] | 0.377 | 0.248 | 125.432 | 190.374 | 1.985 | 3.012 | 1.518x |
| [1, 1, 32768, 64] | [1000, 600] | 0.843 | 0.508 | 126.002 | 208.931 | 1.980 | 3.282 | 1.658x |
| [1, 1, 32768, 64] | [800, 600] | 0.845 | 0.505 | 125.425 | 209.906 | 1.970 | 3.298 | 1.674x |
| [1, 1, 65536, 64] | [1000, 200] | 0.642 | 0.488 | 154.235 | 202.990 | 2.439 | 3.210 | 1.316x |
| [1, 1, 65536, 64] | [1000, 600] | 1.786 | 1.337 | 158.642 | 211.926 | 2.489 | 3.325 | 1.336x |
| [1, 1, 65536, 64] | [800, 600] | 1.812 | 1.380 | 155.844 | 204.745 | 2.445 | 3.213 | 1.314x |